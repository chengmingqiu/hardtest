(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"1FyR":function(e,t,a){"use strict";a.r(t);a("7Kak");var n,s=a("9yH6"),i=(a("giR+"),a("fyUT")),c=(a("8dk+"),a("eZ87")),o=(a("2qtc"),a("kLXV")),l=(a("sRBo"),a("kaz8")),r=(a("g9YV"),a("wCAj")),u=(a("IzEo"),a("bx4M")),d=(a("14J3"),a("BMrR")),g=(a("+L6B"),a("2/Rp")),p=(a("jCWc"),a("kPKH")),m=(a("fOrg"),a("+KLJ")),h=a("VTBJ"),v=a("KQm4"),y=(a("miYZ"),a("tsqr")),S=a("1OyB"),f=a("vuIU"),k=a("JX7q"),b=a("Ji7U"),M=a("LK+K"),x=a("q1tI"),E=a.n(x),C=a("9kvl"),w=a("FKOd"),T=a("EFlr"),D=a.n(T),O="wss://marsts20socket.chinamarketradio.com/hard_ws",I=new WebSocket(O),j=[{value:1,name:"\u611f\u5e94\u64ad\u653e"},{value:3,name:"\u5faa\u73af\u64ad\u653e"}],N=function(e){Object(b["a"])(a,e);var t=Object(M["a"])(a);function a(){var e;return Object(S["a"])(this,a),e=t.call(this),e.onReloadList=function(){var t=e.props.dispatch;t({type:"device/fetchDeviceList",payload:{current:1,pageSize:10,cyid:sessionStorage.getItem("cyid"),siteid:sessionStorage.getItem("siteid")}})},e.autoUpdateDeviceInfo=function(){var t=e.props.dispatch;setTimeout((function(){t({type:"device/updateDeviceInfo",payload:{type:"auto"}}),e.autoUpdateDeviceInfo()}),3e3)},e.onSelectChange=function(t){e.setState({selectDevice:t})},e.onShowSettingModal=function(t){if(e.state.selectDevice.length<1)return y["b"].warning("\u672a\u9009\u62e9\u8bbe\u5907"),!1;var a;switch(t){case 1:a="audio";break;case 2:a="clearSD";break;case 3:a="setVol";break;case 4:a="playType";break}e.setState({settingModalType:a})},e.onHideSettingModal=function(){e.setState({settingModalType:null,selectAudio:[],volValue:1,selectPlayerType:1,setMute:!1,setVolActived:!1})},e.handleConfirmBtn=function(t){switch(t){case 1:e.onSocketSendMsg(4);break;case 2:e.onSocketSendMsg(5);break;case 3:e.onSocketSendMsg(2);break;case 4:e.onSocketSendMsg(2);break}e.onHideSettingModal()},e.selectAudio=function(t){e.setState({selectAudio:t})},e.onChangeVol=function(t){e.setState({volValue:t,setVolActived:!0})},e.onChangeMute=function(t){e.setState({setMute:t.target.checked})},e.onChangePlayerType=function(t){e.setState({selectPlayerType:t.target.value})},e.handleSocket=function(){I.onopen=function(){n.onSocketSendMsg(1),n.onSocketMsg()},I.onclose=function(t){e.setState({wsStatus:!0})}},e.reConnWs=function(t){e.setState((function(e){var a=e.loadings,n=Object(v["a"])(a);return n[t]=!0,{loadings:n}})),I=new WebSocket(O),setTimeout((function(){e.setState((function(e){var a=e.loadings,n=Object(v["a"])(a);return n[t]=!1,{loadings:n,wsStatus:1===I.readyState&&null}}))}),3e3)},e.onSocketSendMsg=function(t){var a={cyid:sessionStorage.getItem("cyid"),siteid:sessionStorage.getItem("siteid")};switch(t){case 1:setTimeout((function(){I.send(JSON.stringify(Object(h["a"])(Object(h["a"])({},a),{},{type:1}))),n.onSocketSendMsg(1)}),1500);break;case 2:a=e.state.setVolActived?Object(h["a"])(Object(h["a"])({},a),{},{type:2,hostID:e.state.selectDevice,mute:e.state.setMute,vol:e.state.volValue,para:e.state.selectPlayerType,touch:0}):Object(h["a"])(Object(h["a"])({},a),{},{type:2,hostID:e.state.selectDevice,mute:e.state.setMute,para:e.state.selectPlayerType,touch:0}),I.send(JSON.stringify(a)),y["b"].success("\u8bbe\u7f6e\u97f3\u91cf\u6210\u529f");break;case 3:I.send(JSON.stringify(Object(h["a"])(Object(h["a"])({},a),{},{type:3,hostID:e.state.selectDevice}))),y["b"].success("\u62cd\u4e00\u62cd\u6210\u529f");break;case 4:I.send(JSON.stringify(Object(h["a"])(Object(h["a"])({},a),{},{type:4,hostID:e.state.selectDevice,audio:e.state.selectAudio}))),y["b"].success("\u8bbe\u7f6e\u8282\u76ee\u5355\u6210\u529f");break;case 5:I.send(JSON.stringify(Object(h["a"])(Object(h["a"])({},a),{},{type:5,hostID:e.state.selectDevice}))),y["b"].success("\u6e05\u9664\u6210\u529f");break}},e.onSocketMsg=function(t){var a=e.props.dispatch;I.onmessage=function(e){if(e.data){var t=JSON.parse(e.data);t.HostID&&a({type:"device/updateDeviceInfo",payload:{data:t,type:"ws"}})}}},e.onChangePage=function(t,a){var n=e.props.dispatch;n({type:"device/fetchDeviceList",payload:{current:t,pageSize:a,cyid:sessionStorage.getItem("cyid"),siteid:sessionStorage.getItem("siteid")}}),e.setState({pagination:{current:t,pageSize:a}})},e.showAlertMsg=function(){return E.a.createElement(d["a"],null,E.a.createElement(p["a"],{xs:24,sm:19,md:19,lg:19,xl:19},E.a.createElement(m["a"],{className:D.a.alertMsg,message:"\u94fe\u63a5\u65ad\u5f00\uff0c\u8bf7\u91cd\u65b0\u94fe\u63a5",type:"error",showIcon:!0})),E.a.createElement(p["a"],{xs:12,sm:4,md:4,lg:4,xl:4},E.a.createElement(g["a"],{className:D.a.reConnBtn,loading:e.state.loadings[0],onClick:function(){return e.reConnWs(0)},type:"primary",danger:!0},"\u91cd\u65b0\u8fde\u63a5")))},e.state={selectedRowKeys:[],volValue:1,volMin:1,volMax:100,settingModalType:null,loading:!1,selectAudio:[],selectDevice:[],selectPlayerType:1,setMute:!1,setVolActived:!1,pagination:{current:1,pageSize:10},loadings:[],wsStatus:null},n=Object(k["a"])(e),e}return Object(f["a"])(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"device/fetchDeviceList",payload:{current:1,pageSize:10,cyid:sessionStorage.getItem("cyid"),siteid:sessionStorage.getItem("siteid")}}),n.handleSocket(),n.autoUpdateDeviceInfo()}},{key:"render",value:function(){var e=this,t=this.props,a=(t.state,t.device,this.state),n=(a.loading,a.selectedRowKeys,this.props.device.list),m=this.props.device.audio,h=this.props.device.pagination,v={selectedRowKeys:this.state.selectDevice,onChange:this.onSelectChange},y=[{title:"\u8bbe\u5907\u53f7",dataIndex:"HostID",valueType:"text",align:"center"},{title:"\u8bbe\u5907\u72b6\u6001",dataIndex:"status",valueType:"text",align:"center",render:function(e){return 0===e?"\u79bb\u7ebf":"\u5728\u7ebf"}},{title:"\u7535\u91cf",dataIndex:"BatVol",valueType:"text",align:"center"},{title:"\u4fe1\u53f7",dataIndex:"Rssi",valueType:"text",align:"center"},{title:"\u97f3\u91cf",dataIndex:"Vol",valueType:"text",align:"center"},{title:"\u9759\u97f3",dataIndex:"Mute",valueType:"text",align:"center",render:function(e){return!1===e?"\u5173\u95ed":!0===e?"\u5f00\u542f":"-"}},{title:"\u7ea2\u5916\u68c0\u6d4b\u6570",dataIndex:"audPC",valueType:"text",align:"center"},{title:"\u64ad\u653e\u65b9\u5f0f",dataIndex:"Para",valueType:"text",align:"center",render:function(e){return 1===e?"\u611f\u5e94":3===e?"\u5faa\u73af":"-"}}];return E.a.createElement(w["a"],null,E.a.createElement(u["a"],null,!0===this.state.wsStatus&&this.showAlertMsg(),E.a.createElement(d["a"],{justify:"end"},E.a.createElement(p["a"],{xs:12,sm:4,md:4,lg:4,xl:3},E.a.createElement(g["a"],{className:D.a.actionBtn,type:"primary",danger:!0,onClick:function(){return e.onReloadList()}},"\u5237\u65b0\u5217\u8868")),E.a.createElement(p["a"],{xs:12,sm:4,md:4,lg:4,xl:3},E.a.createElement(g["a"],{className:D.a.actionBtn,type:"primary",onClick:function(){return e.onShowSettingModal(1)}},"\u4e0b\u8f7d\u97f3\u9891")),E.a.createElement(p["a"],{xs:12,sm:4,md:4,lg:4,xl:3},E.a.createElement(g["a"],{className:D.a.actionBtn,type:"primary",onClick:function(){return e.onShowSettingModal(2)}},"\u6e05\u7a7aSD\u5361")),E.a.createElement(p["a"],{xs:12,sm:4,md:4,lg:4,xl:3},E.a.createElement(g["a"],{className:D.a.actionBtn,type:"primary",onClick:function(){return e.onShowSettingModal(3)}},"\u97f3\u91cf\u8bbe\u7f6e")),E.a.createElement(p["a"],{xs:12,sm:4,md:4,lg:4,xl:3},E.a.createElement(g["a"],{className:D.a.actionBtn,type:"primary",onClick:function(){return e.onShowSettingModal(4)}},"\u64ad\u653e\u65b9\u5f0f")))),E.a.createElement(u["a"],null,n&&Object.keys(n).length>0&&E.a.createElement(r["a"],{rowSelection:v,rowKey:"HostID",columns:y,dataSource:n,pagination:{showSizeChanger:!0,showQuickJumper:!0,total:h.total,current:this.state.current,pageSize:this.state.pageSize,pageSizeOptions:[10,20,30],onShowSizeChange:function(t,a){e.setState({pageSize:a})},onChange:function(t,a){e.onChangePage(t,a)},showTotal:function(e){return"\u5171\u8ba1 ".concat(h.total," \u53f0\u8bbe\u5907")}}})),E.a.createElement(o["a"],{title:"\u4e0b\u8f7d\u97f3\u9891",visible:"audio"==this.state.settingModalType,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",closable:!1,onCancel:this.onHideSettingModal,onOk:function(){return e.handleConfirmBtn(1)}},E.a.createElement("div",null,E.a.createElement(l["a"].Group,{style:{width:"100%"},onChange:this.selectAudio,value:this.state.selectAudio},E.a.createElement(d["a"],null,E.a.createElement(p["a"],{span:4},"\u9009\u62e9\u97f3\u9891\uff1a"),E.a.createElement(p["a"],{span:20},E.a.createElement(d["a"],null,m.length>0&&m.map((function(e,t){return E.a.createElement(p["a"],{key:e.id,span:8},E.a.createElement(l["a"],{value:e.id},e.title))}))))))),E.a.createElement("div",{className:D.a.audioMaxNum},"(\u6ce8\uff1a\u6700\u591a3\u6761)"),E.a.createElement("div",{className:D.a.selectDeviceNum},"\u5df2\u9009\uff1a",this.state.selectDevice.length,"\u53f0\u8bbe\u5907")),E.a.createElement(o["a"],{title:"\u6e05\u7a7aSD\u5361",visible:"clearSD"==this.state.settingModalType,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onCancel:this.onHideSettingModal,onOk:function(){return e.handleConfirmBtn(2)}},E.a.createElement("div",null,"\u63d0\u793a\uff1a\u5df2\u4e0b\u8f7d\u8fc7\u7684\u97f3\u9891\uff0c\u9700\u8981\u6e05\u7a7asd\u5361\u624d\u53ef\u91cd\u65b0\u4e0b\u8f7d\u3002"),E.a.createElement("div",{className:D.a.selectDeviceNum},"\u5df2\u9009\uff1a",this.state.selectDevice.length,"\u53f0\u8bbe\u5907")),E.a.createElement(o["a"],{title:"\u97f3\u91cf\u8bbe\u7f6e",visible:"setVol"==this.state.settingModalType,okText:"\u4fdd\u5b58",cancelText:"\u5173\u95ed",onCancel:this.onHideSettingModal,onOk:function(){return e.handleConfirmBtn(3)}},E.a.createElement("div",{style:{display:"block",width:"200px",margin:"0 auto"}},E.a.createElement(d["a"],null,E.a.createElement(p["a"],{span:20},E.a.createElement(c["a"],{min:this.state.volMin,max:this.state.volMax,step:1,onChange:this.onChangeVol,value:"number"===typeof this.state.volValue?this.state.volValue:0})),E.a.createElement(p["a"],{span:4},E.a.createElement(i["a"],{min:this.state.volMin,max:this.state.volMax,step:1,style:{margin:"0 16px",width:"70px"},value:this.state.volValue,onChange:this.onChangeVol})),E.a.createElement("div",null,E.a.createElement(l["a"],{checked:this.state.setMute,onChange:this.onChangeMute},"\u5f00\u542f\u9759\u97f3"))))),E.a.createElement(o["a"],{title:"\u64ad\u653e\u65b9\u5f0f\u8bbe\u7f6e",visible:"playType"==this.state.settingModalType,okText:"\u4fdd\u5b58",cancelText:"\u5173\u95ed",onCancel:this.onHideSettingModal,onOk:function(){return e.handleConfirmBtn(4)}},E.a.createElement("div",{style:{display:"block",width:"200px",margin:"0 auto"}},E.a.createElement(s["a"].Group,{onChange:this.onChangePlayerType,value:this.state.selectPlayerType},j.map((function(e){return E.a.createElement(s["a"],{key:e.value,value:e.value},e.name)}))))))}}]),a}(x["Component"]);t["default"]=Object(C["a"])((function(e){var t=e.device,a=e.loading;return{device:t,loading:a.effects["device/fetchDeviceList"]}}))(N)},EFlr:function(e,t,a){e.exports={actionBtn:"actionBtn___3O0ab",alertMsg:"alertMsg___zmOeb",reConnBtn:"reConnBtn___23jU-",selectDeviceNum:"selectDeviceNum___3IPX8",audioMaxNum:"audioMaxNum___2aiFD"}}}]);